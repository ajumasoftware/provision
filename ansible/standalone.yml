---
- name: deploy ajuma on {{HOST}}
  hosts: "{{HOST}}"
  vars:
    # Defaults can be overridden with --extra-vars flag
    USER: ubuntu
    DB_NAME: ajuma
    domain: ajumasoftware
    NAME: app
    DJANGODIR: /home/ubuntu/app
    SOCKFILE: /tmp/gunicorn.sock
    ACTIVATE: /home/ubuntu/virtualenv/bin/activate
    NAME: app
    SETTINGS: ajumasoftware.settings
    WSGI: "ajumasoftware.wsgi:application"
    PLATFORM: standalone
    requirements: /home/ubuntu/tcart/requirements.txt
  roles:
    - set_facts
    - apt_cleanup
    - system_packages
    - user

    # Leave these roles in for future reference
    # - hosts_file
    # - role: postgresql
    #  postgresql_version: 9.6
    #  postgresql_users:
    #    - name: ubuntu
    #      pass: 'ajuma'
    #  postgresql_databases:
    #    - name: "{{ DB_NAME }}"
    #      owner: ubuntu
    #  postgresql_user_privileges:
    #    - name: ubuntu
    #      db: "{{ DB_NAME }}"
    #      priv: "ALL"
    #      role_attr_flags: "CREATEDB,CREATEROLE,SUPERUSER"

    - django
    - gunicorn
    - nginx
